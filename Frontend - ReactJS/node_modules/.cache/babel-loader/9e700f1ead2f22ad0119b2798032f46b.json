{"ast":null,"code":"import _classCallCheck from\"C:/Users/amine/Desktop/Projet JEE/Frontend/titsuite/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/amine/Desktop/Projet JEE/Frontend/titsuite/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/amine/Desktop/Projet JEE/Frontend/titsuite/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/amine/Desktop/Projet JEE/Frontend/titsuite/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import LandingPage from'./components/Landing';import navBar from'./components/NavBar';import LandingPage2 from'./components/LandingPage';import Login from'./components/Login';import SignUp from'./components/SignUp';import Dashboard from'./components/Dashboard';import{Route,BrowserRouter as Router,Switch,Link}from\"react-router-dom\";import Landing from'./components/Landing';import Portfeuille from'./components/Portfeuille';import MesAnnonces from'./components/MesAnnonces';import Profile from'./components/Profile';import{React,Component}from'react';import UnauthGuard from'./components/UnauthGuard';import AuthGuard from'./components/AuthGuard';import CustomerProfile from'./components/CustomerProfile';import CustomerDashboard from'./components/CustomerDashboard';import CustomerHistorique from'./components/CustomerHistorique';import ServiceClient from'./components/ServiceClient';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);_this=_super.call(this);_this.expiresIn=900*1000;_this.refreshTimer=null;_this.callTimeout=null;_this.authenticate=function(){_this.setState({isAuthenticated:true});localStorage.setItem(\"isAuthCheck\",\"\");localStorage.setItem(\"expiryTime\",Date.now()+_this.expiresIn);_this.setAutoLoginInterval();};_this.logout=function(){_this.setState({isAuthenticated:false});clearTimeout(_this.callTimeout);clearInterval(_this.refreshTimer);localStorage.clear();};_this.autoLoginCallback=function(key){var requestOptions={method:'GET',headers:{'Content-Type':'application/json'}};fetch('/Titsuite-1.0-SNAPSHOT/api/users/refreshToken',requestOptions).then(function(res){return res.json();}).then(function(data){console.log(data);localStorage.setItem(key,Date.now()+_this.expiresIn);});};_this.setAutoLoginInterval=function(){var key='expiryTime';var now=Date.now();var expiryTime=localStorage.getItem(key);var executeCallback=function executeCallback(){_this.autoLoginCallback(key);};if(expiryTime!=null){// User is logged in\nif(now>=expiryTime){// User has been away longer than expiryTime, log him out\nlocalStorage.removeItem(key);_this.logout();}else{// Execute callback when we reach the next interval\n_this.callTimeout=setTimeout(function(){_this.refreshTimer=setInterval(executeCallback,_this.expiresIn);executeCallback();},expiryTime-now);}}};_this.state={isAuthenticated:false};var auth=localStorage.getItem(\"isAuthCheck\");if(auth!=null)_this.state.isAuthenticated=true;return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){this.setAutoLoginInterval();}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){clearTimeout(this.callTimeout);clearInterval(this.refreshTimer);}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,component:LandingPage2}),/*#__PURE__*/_jsx(AuthGuard,{path:\"/dashboard\",auth:this.state.isAuthenticated,rest:{logout:this.logout},component:Dashboard}),/*#__PURE__*/_jsx(AuthGuard,{path:\"/customer/dashboard\",auth:this.state.isAuthenticated,rest:{logout:this.logout},component:CustomerDashboard}),/*#__PURE__*/_jsx(AuthGuard,{path:\"/portfeuille\",auth:this.state.isAuthenticated,rest:{logout:this.logout},component:Portfeuille}),/*#__PURE__*/_jsx(AuthGuard,{path:\"/customer/historique\",auth:this.state.isAuthenticated,rest:{logout:this.logout},component:CustomerHistorique}),/*#__PURE__*/_jsx(UnauthGuard,{path:\"/signup\",auth:this.state.isAuthenticated,component:SignUp}),/*#__PURE__*/_jsx(UnauthGuard,{path:\"/login\",auth:this.state.isAuthenticated,rest:{authenticate:this.authenticate},component:Login}),/*#__PURE__*/_jsx(AuthGuard,{path:\"/freelancer/profile\",auth:this.state.isAuthenticated,rest:{logout:this.logout},component:Profile}),/*#__PURE__*/_jsx(AuthGuard,{path:\"/customer/profile\",auth:this.state.isAuthenticated,rest:{logout:this.logout},component:CustomerProfile}),/*#__PURE__*/_jsx(AuthGuard,{path:\"/annonces\",auth:this.state.isAuthenticated,rest:{logout:this.logout},component:MesAnnonces}),/*#__PURE__*/_jsx(AuthGuard,{path:\"/service-client\",auth:this.state.isAuthenticated,rest:{logout:this.logout},component:ServiceClient})]})})});}}]);return App;}(Component);export{App as default};","map":{"version":3,"sources":["C:/Users/amine/Desktop/Projet JEE/Frontend/titsuite/src/App.js"],"names":["LandingPage","navBar","LandingPage2","Login","SignUp","Dashboard","Route","BrowserRouter","Router","Switch","Link","Landing","Portfeuille","MesAnnonces","Profile","React","Component","UnauthGuard","AuthGuard","CustomerProfile","CustomerDashboard","CustomerHistorique","ServiceClient","App","expiresIn","refreshTimer","callTimeout","authenticate","setState","isAuthenticated","localStorage","setItem","Date","now","setAutoLoginInterval","logout","clearTimeout","clearInterval","clear","autoLoginCallback","key","requestOptions","method","headers","fetch","then","res","json","data","console","log","expiryTime","getItem","executeCallback","removeItem","setTimeout","setInterval","state","auth"],"mappings":"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","sourcesContent":["import LandingPage from './components/Landing';\r\nimport navBar from './components/NavBar';\r\n\r\nimport LandingPage2 from './components/LandingPage'\r\nimport Login from './components/Login'\r\nimport SignUp from './components/SignUp';\r\nimport Dashboard from './components/Dashboard';\r\nimport {Route, BrowserRouter as Router, Switch, Link} from \"react-router-dom\"\r\nimport Landing from './components/Landing';\r\nimport Portfeuille from './components/Portfeuille';\r\nimport MesAnnonces from './components/MesAnnonces';\r\nimport Profile from './components/Profile';\r\nimport { React, Component } from 'react';\r\nimport UnauthGuard from './components/UnauthGuard';\r\nimport AuthGuard from './components/AuthGuard';\r\nimport CustomerProfile from './components/CustomerProfile'\r\nimport CustomerDashboard from './components/CustomerDashboard';\r\nimport CustomerHistorique from './components/CustomerHistorique';\r\nimport ServiceClient from './components/ServiceClient';\r\n\r\nexport default class App extends Component {\r\n  expiresIn = 900 * 1000;\r\n  \r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      isAuthenticated: false,\r\n    };\r\n    const auth = localStorage.getItem(\"isAuthCheck\");\r\n    if (auth != null)\r\n      this.state.isAuthenticated = true;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setAutoLoginInterval();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    clearTimeout(this.callTimeout);\r\n    clearInterval(this.refreshTimer);\r\n  }\r\n\r\n  refreshTimer = null;\r\n  callTimeout = null;\r\n\r\n  authenticate = () => {\r\n    this.setState({\r\n      isAuthenticated: true\r\n    });\r\n    localStorage.setItem(\"isAuthCheck\", \"\");\r\n    localStorage.setItem(\"expiryTime\", Date.now() + this.expiresIn);\r\n    this.setAutoLoginInterval();\r\n  }\r\n\r\n  logout = () => {\r\n    this.setState({\r\n      isAuthenticated: false\r\n    });\r\n    clearTimeout(this.callTimeout);\r\n    clearInterval(this.refreshTimer);\r\n    localStorage.clear();\r\n  }\r\n\r\n  autoLoginCallback = (key) => {\r\n    const requestOptions = {\r\n      method: 'GET',\r\n      headers: { 'Content-Type': 'application/json' }\r\n    };\r\n    fetch('/Titsuite-1.0-SNAPSHOT/api/users/refreshToken', requestOptions).then(res => res.json()).then((data) => {\r\n      console.log(data);\r\n      localStorage.setItem(key, Date.now() + this.expiresIn);\r\n    });\r\n  }\r\n\r\n  setAutoLoginInterval = () => {\r\n    const key = 'expiryTime';\r\n    const now = Date.now();\r\n    const expiryTime = localStorage.getItem(key);\r\n    const executeCallback = () => {\r\n      this.autoLoginCallback(key);\r\n    };\r\n    if (expiryTime != null) { // User is logged in\r\n      if (now >= expiryTime) { // User has been away longer than expiryTime, log him out\r\n        localStorage.removeItem(key);\r\n        this.logout();\r\n      }\r\n      else { // Execute callback when we reach the next interval\r\n        this.callTimeout = setTimeout(() => {\r\n          this.refreshTimer = setInterval(executeCallback, this.expiresIn);\r\n          executeCallback();\r\n        }, expiryTime - now);\r\n      }\r\n    }\r\n  }\r\n\r\n  render(){\r\n    return (\r\n    <div className=\"App\">\r\n      \r\n\r\n      <Router>\r\n        <Switch>\r\n          <Route path=\"/\" exact component={LandingPage2}/>\r\n          {/* <Route path=\"/login\" component={Login} />\r\n          <Route path=\"/signup\" component={SignUp} /> */}\r\n          <AuthGuard path=\"/dashboard\" auth={this.state.isAuthenticated}  rest={{logout: this.logout}} component={Dashboard} />\r\n          <AuthGuard path=\"/customer/dashboard\" auth={this.state.isAuthenticated}  rest={{logout: this.logout}} component={CustomerDashboard} />\r\n          <AuthGuard path=\"/portfeuille\" auth={this.state.isAuthenticated}  rest={{logout: this.logout}} component={Portfeuille} />\r\n          <AuthGuard path=\"/customer/historique\" auth={this.state.isAuthenticated}  rest={{logout: this.logout}} component={CustomerHistorique} /> \r\n          {/* <Route path=\"/annonces\" component={MesAnnonces}/>\r\n          <Route path=\"/freelancer/profile\" component={Profile} /> */}\r\n\r\n          <UnauthGuard path=\"/signup\" auth={this.state.isAuthenticated} component={SignUp} />\r\n          <UnauthGuard path=\"/login\" auth={this.state.isAuthenticated} rest={{authenticate: this.authenticate}} component={Login} />\r\n          <AuthGuard path=\"/freelancer/profile\" auth={this.state.isAuthenticated} rest={{logout: this.logout}} component={Profile} />\r\n          <AuthGuard path=\"/customer/profile\" auth={this.state.isAuthenticated} rest={{logout: this.logout}} component={CustomerProfile} />\r\n          \r\n          <AuthGuard path=\"/annonces\" auth={this.state.isAuthenticated} rest={{logout: this.logout}} component={MesAnnonces} />\r\n          <AuthGuard path=\"/service-client\" auth={this.state.isAuthenticated} rest={{logout: this.logout}} component={ServiceClient} />\r\n        </Switch>\r\n      </Router>\r\n    </div>\r\n  );\r\n  }\r\n  \r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}